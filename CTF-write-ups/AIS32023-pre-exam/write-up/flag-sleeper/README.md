# Flag Sleeper

## Information

- `Hello World ğŸŒ±` `Easy` `MyFirstCTF`
- `Reverse`

Taking a nap before entering the world of AIS3 is important! A good hacker requires good sleep, and so does this flag checker.

Author: TwinkleStar03 âœ¨

## Solution
é¡Œç›®ä¸­æä¾›ä¸€å€‹å£“ç¸®æª”ï¼Œå…¶ä¸­å…§å®¹åƒ…åŒ…å«ä¸€å€‹ ELF 64bits çš„ binary æª”ã€‚

é€éåçµ„è­¯ã€åç·¨è­¯å·¥å…·å° binary å…§å®¹é€²è¡ŒæŸ¥çœ‹ã€‚

- IDA Pro ä¸€ä¸‹
    ```c
     v4 = time(0LL);
    srand(v4 + 3158064);
    while ( v5 != 52 )
    {
      v6 = rand() % 52;
      v7 = v8[v6];
      if ( a2[1][v7] != (v10[v6] ^ v9[v6]) )
      {
        puts(&s);
        return 1LL;
      }
      if ( !v11[v7] )
        ++v5;
      ++v11[v7];
      sleep(1u);
    }
    puts(&byte_2041);
    return 0LL;
    }
    else
    {
        puts(&s);
        return 1LL;
    }
    ```

é€éå…§å®¹å¯ä»¥çœ‹å‡ºå…¶çµæœæœƒæ˜¯ argv[1] èˆ‡å‰æ–¹å·²ç¶“å®šç¾©çš„ v8, v9, v10 é€²è¡Œæ“ä½œæ¯”å°ã€‚
    - æ“ä½œå¦‚ä¸‹
        ```c
        v6 = rand() % 52;
        v7 = v8[v6];
        if ( a2[1][v7] != (v10[v6] ^ v9[v6]) )
            ...
        ```

- ç¶œä¸Šæ‰€çŸ¥ï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹å…§å®¹ã€‚
    - v8 è¢«ç•¶ä½œ indexã€‚
    - v9, v10 æ˜¯æ“ä½œæ¯”å°çš„ç›®æ¨™å°è±¡ã€‚
    - æ“ä½œç‚º a2[1][v8[i]] = v9[i]^v10[i]ï¼Œå…¶ä¸­ i ç‚º rand()%52ã€‚
    - rand() æ²’ç”šéº¼ç”¨è™•ã€‚

- python è…³æœ¬
    - æ•´ç† v8, v9, v10ï¼Œæ ¹æ“šé‚è¼¯é€†æ¨ã€‚
    ```py
    v8 = [10, 12, 28, 7, 38, 31, 47, 44, 42, 35, 48, 30, 21, 11, 17, 16, 34, 40, 33, 39, 41, 9, 22, 4, 6, 20, 19, 46, 23, 45, 26, 0, 15, 3, 8, 43, 14, 5, 2, 27, 49, 1, 51, 36, 37, 24, 25, 50, 32, 13, 29, 18]
    v9 = [212, 232, 164, 28, 253, 132, 194, 47, 46, 150, 96, 216, 121, 216, 140, 164, 49, 219, 147, 252, 201, 28, 9, 188, 155, 79, 133, 255, 104, 20, 87, 64, 147, 143, 68, 147, 142, 96, 165, 244, 62, 58, 119, 25, 61, 56, 71, 182, 7, 37, 1, 154]
    v10 = [237, 217, 212, 40, 149, 219, 165, 112, 29, 241, 8, 189, 13, 224, 211, 149, 5, 184, 255, 207, 162, 122, 86, 199, 170, 122, 240, 206, 9, 102, 102, 1, 163, 188, 119, 225, 239, 3, 246, 153, 9, 115, 10, 70, 94, 103, 52, 137, 97, 29, 109, 208]

    flag = [None]*52

    for i in range(52):
        flag[v8[i]] = chr(v9[i]^v10[i])

    for i in flag:
        print(i, end='')
    print()
    ```