# Authentication bypass via information disclosure

## Information
---
- [PortSwigger - Lab: Authentication bypass via information disclosure](https://portswigger.net/web-security/information-disclosure/exploiting/lab-infoleak-authentication-bypass)
    This lab's administration interface has an authentication bypass vulnerability, but it is impractical to exploit without knowledge of a custom HTTP header used by the front-end.

    To solve the lab, obtain the header name then use it to bypass the lab's authentication. Access the admin interface and delete Carlos's account.

    You can log in to your own account using the following credentials: wiener:peter 

## Solution
---

- [HTTP TRACE method](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/TRACE): The HTTP TRACE method performs a message loop-back test along the path to the target resource, providing a useful debugging mechanism.
    - The final recipient of the request should reflect the message received.

1. 透過 TRACE method 獲取伺服器收到的 request。
    ``` 
    TRACE /admin HTTP/1.1
    ...
    ```
2. 因為測試得知 admin 需在 local 端或以管理員身分進行登入才可獲取權限，則將 `X-Custom-IP-Authorization: `更改為 `127.0.0.1`。
    - **method1**: 利用 Burp Suite 更改 Response。
        - `Proxy` -> `Options` -> `Match and Replace` 添加 `X-Custom-IP-Authorization: 127.0.0.1`。 
    - **method2**: 添加至 Request。
        ```
        ...
        X-Custom-Authorization: 127.0.0.1
        ...
        ```